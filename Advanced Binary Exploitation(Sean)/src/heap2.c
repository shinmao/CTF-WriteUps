#include <stdio.h>
#include <stdlib.h>

char padding[64]; // make sure that &P - 24 is safe
char *q, *p;

void goal() {
    system("/bin/sh");
}

int main() {
    setvbuf(stdout, 0, _IONBF, 0);

    p = malloc(256 - 8);
    q = malloc(256 - 8);

    while (1) {
        printf("P = %p\n", p);
        gets(p);
        if (q) {
            free(q);
            q = 0;
        }
    }

    exit(0);
}
